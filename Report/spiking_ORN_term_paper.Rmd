---
title: "Spiking ORN"
author: |
  | Shivansh Dave 
  | Biology Department, Case Western Reserve University
  | shivansh@case.edu
date: |
  | August 1, 2021
  | 
  | *To be submitted as a term paper for BIOL 478 (Spring, 2021)*
  | *Computational Neuroscience by Dr. Peter J. Thomas*

output: 
  bookdown::pdf_document2:
    toc: true
    toc_depth: 2
    keep_tex: true
    number_sections: true
    extra_dependencies: ["subfig"]
    
header-includes:
  \usepackage{float}

bibliography: 478_spiking_ORN_modeling.bib
---

```{r global-options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE,fig.align='center') #warning=FALSE, message=FALSE
```

\newpage
\floatplacement{figure}{!htb}

<!-- Text  -->
# Summary {-}

[@reisert99adaptation] 



# Introduction





\clearpage

# Methods

## Spiking ORN model

> add arrow notations


```{r model, engine="dot", code=xfun::read_utf8('spiking_ORN_model.gv'), out.width="110%", fig.cap="Spiking ORN mechanistic model diagram", cache=TRUE}

```

- *O_stim* : Odor stimulus
- *bLR* : Ligand-bound receptors
- *aG* : Active-state G-proteins
- *cAMP* : Cyclic adenosine monophosphate (AMP)
- *Ca^2+* : cytosolic free $Ca^{2+}$ ions
- *CaCaM* : $Ca^{2+}$-calmodulin
- *aCaMK* : active state of *CaCaM*-dependent protein kinase (CaMK)
- *V_ORN* : 
- *V_ML* : 
- *nK* : 
- *CaFR* : 
- *I_ORN* : 


## ORN operation

Ligand-receptor binding
G-protein activation

\begin{equation} 
\begin{split}
O_{\text{stim}} &= \text{od} \cdot [ H(t-t_0) - H(t-t_1) ];\ \ \ \ \  \text{(single pulse)}  \\
\frac{d\ \mathbf{bLR}}{dt} &= \text{k1} \cdot O_{\text{stim}} \cdot (\text{Rtot} - \mathbf{bLR}) - \text{r1} \cdot \mathbf{bLR} \\
\frac{d\ \mathbf{aG}}{dt} &= \text{k2} \cdot \mathbf{bLR} \cdot (\text{Gtot} - \mathbf{aG}) - \text{r2} \cdot \mathbf{aG}
\end{split}
\end{equation}

- **_H_(.)** - Heaviside step function, **od** odor-concentration

Intracellular signalling

\begin{equation}
\begin{split}
\frac{d\ \mathbf{cAMP}}{dt} &= synth - pd \cdot \mathbf{cAMP} \\
\frac{d\ \mathbf{Ca}}{dt} &= \text{inf}\cdot I_{\text{CNG}} - J_{\text{NCX}} - (\text{cc1} \cdot \mathbf{Ca} - \text{cc2} \cdot \mathbf{CaCaM}) \\
\frac{d\ \mathbf{CaCaM}}{dt} &= \text{cc1} \cdot \mathbf{Ca} - \text{cc2} \cdot \mathbf{CaCaM} \\
\frac{d\ \mathbf{aCaMK}}{dt} &= \text{ck1} \cdot \mathbf{CaCaM} - \text{ck2} \cdot \mathbf{aCaMK}
\end{split}
\end{equation}

\begin{equation}
\begin{split}
\frac{d\ \mathbf{IX}}{dt} &= \text{cx1} \cdot \mathbf{Ca} - \text{cx2} \cdot \mathbf{IX} \\
synth &= \frac{\mathbf{aG} \cdot \text{smax}}{1 + (\mathbf{aCaMK} / \text{kinh} )^{\text{ninh}}} \\
&J_{\text{NCX}} = \text{ef}\cdot \mathbf{Ca}/[1+(\mathbf{IX}/\text{kI})^{\text{nI}}] \\
\end{split}
\end{equation}

Effector Channel Activity / Receptor Currents

\begin{equation}
\begin{split}
\frac{d\ \mathbf{V_{ORN}}}{dt} &= \frac{1}{\text{cap}} \cdot (\ I_{\text{CNG}} + I_{\text{Cl(Ca)}} + I_{\text{leak}}\ ) \\
I_{\text{CNG}} &= \frac{\text{cnmax} \cdot \mathbf{cAMP}^{\text{n}_1} \cdot (\text{vcng}-\mathbf{V_{ORN}})}{\mathbf{cAMP}^{\text{n}_1} + (inhcng \cdot \text{hmc}_1)^{\text{n}_1}} \\
inhcng &= 1 + \frac{(\text{inhmax}-1)\cdot \mathbf{CaCaM}^{\text{ninhcng}}}{\mathbf{CaCaM}^{\text{ninhcng}} + \text{kinhcng}^{\text{ninhcng}}} \\
I_{\text{Cl(Ca)}} &= \frac{\text{clmax}\cdot \mathbf{Ca}^{\text{n}_2}\cdot (\text{vcl} - \mathbf{V_{ORN}})}{\mathbf{Ca}^{\text{n}_2} + \text{hmc}_2^{\text{n}_2}} \\
I_{\text{leak}} &= \text{gl}\cdot (\text{vl} - \mathbf{V_{ORN}})
\end{split}
\end{equation}




> FIG : Conc/Adap

## ML spikes {#ML}

<!-- ML : V & nK -->
\begin{align} 
\frac{d\ \mathbf{V_{ML}}}{dt} =& \frac{ct \cdot \mathbf{CaFR}}{C_m}( I_{ions} + I_{Ca} - gL(\mathbf{V_{ML}}-v_L) \notag \\
&- gK \cdot \mathbf{nK} \cdot (\mathbf{V_{ML}}-v_K) - gCa \cdot M_{\infty} \cdot (\mathbf{V_{ML}}-v_{Ca}) \ ) \notag \\
\frac{d\ \mathbf{nK}}{dt} =& \frac{{ct \cdot \mathbf{CaFR}} 
[ n_{\infty}(\mathbf{V_{ML}}) - \mathbf{nK} ]}{\tau(\mathbf{V_{ML})}}  \notag
\end{align} 

<!-- ML : V_ORN vales -->
\begin{equation} (\#eq:par)
\begin{split}
&v_{\rm Ca} = 120\ mV,\  v_{\rm K} = -84\ mV,\ v_{\rm L} = -60\ mV,
\\ &g_{\rm Ca} = 4.4\ m\mho/cm^2, \ g_{K\rm } = 8\ m\mho/cm^2,\ 
    g_{\rm L} = 2\ m\mho/cm^2,
\\ &C = 20\ \mu F/cm^2,\ I_{\rm app} = (variable;\ measured\ in\ 
    \mu A/cm^2) 
\end{split} \notag
\end{equation}

<!-- ML : functions -->
\begin{align}
\nonumber \phi=0.04\ s^{-1},\ v_a&=-1.2\ mV,\ v_b=18\ mV,\ v_c=2\ mV,\ v_d=30\ mV, \notag \\
\xi = \frac{v-v_c}{v_d},\ 
    &\alpha(v) = \frac{\phi \cosh(\xi/2)}{1+ e^{2\xi}},\ 
    \beta(v) = \frac{\phi \cosh(\xi/2)}{1+ e^{-2\xi}}, \notag \\
n_\infty(v) &= \frac{\alpha(v)}{\alpha(v) + \beta(v)} \ 
    =\  \frac12(1 + \tanh \xi) \notag \\
m_\infty &= \frac12\left(1+ \tanh(\frac{v-v_a}{vb})\right) \notag \\ 
\tau(v) &= \frac{1}{\alpha(v) + \beta(v)} \ 
    =\  \frac{1}{\phi \cosh(\xi/2)}
\end{align}

### CaFR modulation

<!-- CaFR -->
\begin{equation} 
\frac{d \mathbf{CaFR}}{dt} = (1+\mathbf{Ca})*(p(d\mathbf{Ca} > 0) - n(d\mathbf{Ca}<0\  \& \ d\mathbf{CaFR} > m)) \notag
\end{equation} 

### Ionic currents


### ML spikes added in ORN

> Add spike-marks

```{r MLspkORN, out.width = "80%", fig.cap="Resuling ORN current due to Morris-Lecar spikes"}
knitr::include_graphics(c('figs/v1/fig_ML_spikes_with_ORN.png')) 
```

> Add spike-marks

```{r rORN, out.width = "80%", fig.cap="Spiking ORN operation and key underlying component traces"}
knitr::include_graphics(c('figs/v1/fig_spk_all_components.png')) 
```


## Sniffing experiment

### odor stimulus
diff Breaths/min and diff concentration


\clearpage

# Results

## Spiking in ORN


### Response to concentration changes

```{r rCon, out.width = "80%", fig.cap="Resulting spiking ORN for different concentrations"}
knitr::include_graphics(c('figs/v1/fig_spk_compare_conc.png')) 
```

*ORN Spike-response profiling*

```{r MLquant, out.width = "80%", fig.cap="ORN spike-response profiling for different stimulus concentrations"}
knitr::include_graphics(c('figs/v1/fig_spk_compare_conc_quant.png')) 
```

### Response to duration changes

Does not affect much, indicates adaptation

### Response to Adaptation

```{r rAdp, out.width = "80%", fig.cap="Effect of adaptation on ORN spiking"}
knitr::include_graphics(c('figs/v1/fig_spk_compare_adaptation.png')) 
```

Does affect. Hypothesis : longer inter-stim interval will cause lesser adaptation than shorter-intervals

## Optimal sniffing frequency

Number of spikes during the first-sniff vs steady-state

```{r , out.width = "80%", fig.cap="Count"}
knitr::include_graphics(c('figs/v1/fig_sniff_freq_FR_tuning_raw.png')) 
```

### ORN sensitivity vs sniffing frequency

Spike-count / stimulus-duration

Adaptation vs sniffing frequency

```{r , out.width = "80%", fig.cap="Adap"}
knitr::include_graphics(c('figs/v1/fig_sniff_freq_FR_tuning_gain.png')) 
```

# Discussion and Conclusions {#CD}

1. **res-1.**
  
  Figure shows 
  

\clearpage 

# (APPENDIX) Appendix {-}


# Appendix A : Comparing experimental data with simulation {-}

## ORN transduction {-}

### Varying odor-concentration 

```{r r99f2, out.width = "80%", fig.cap="Receptor current responses of an olfactory receptor cell (Fig-2; Reisert 1999)"}
knitr::include_graphics('figs/Reisert1999/fig_txn_compare_conc_quant_R99_F2.png') 
```

\@ref(fig:TxConAB)

```{r TxConAB, out.width = "80%", fig.cap="Transduction comparison for various odor concentration", fig.subcap=c('Cell current raw traces', 'Quantification', '(c)'), fig.sep='\\par'}
knitr::include_graphics(c('figs/v1/fig_txn_compare_conc.png','figs/v1/fig_txn_compare_conc_quant.png')) 
```

### Effect of adaptation

```{r r99f4, out.width = "80%", fig.cap="The effect of adaptation on the odour-induced receptor current (Fig-4; Reisert 1999)"}
knitr::include_graphics('figs/Reisert1999/fig_txn_compare_adaptation_R99_F4.png') 
```

```{r TxAdp, out.width = "80%", fig.cap="Transduction comparison for adaptation"}
knitr::include_graphics(c('figs/v1/fig_txn_compare_adaptation.png')) 
```

### Effect of stimulus duration

```{r TxDur, out.width = "80%", fig.cap="Transduction comparison for various odor durations"}
knitr::include_graphics(c('figs/v1/fig_txn_compare_dur.png')) 
```

```{r rDur, out.width = "80%", fig.cap="Spiking ORN response for stimulus duration"}
knitr::include_graphics(c('figs/v1/fig_spk_compare_dur.png')) 
```

## Spikes in ORN {-}

### Experimental data

```{r r99f1, out.width = "80%", fig.cap="Responses of an olfactory receptor cell to odour stimuli of increasing concentration recorded with the suction pipette technique (Fig-1; Reisert 1999)"}
knitr::include_graphics('figs/Reisert1999/fig_spk_compare_conc_R99_F1.png') 
```

```{r r99f5, out.width = "80%", fig.cap="The effect of adaptation on the odour-induced spike firing response (Fig-5; Reisert 1999)"}
knitr::include_graphics('figs/Reisert1999/fig_spk_compare_adaptation_R99_F5.png') 
```

```{r r99f3, out.width = "80%", fig.cap="Collected dose-response data from six cells (Fig-3; Reisert 1999)"}
knitr::include_graphics('figs/Reisert1999/fig_spk_compare_conc_quant_R99_F3.png') 
```

### Spike identification

```{r MLspkID, out.width = "80%", fig.cap="Identifying ML-spikes to indicate an event responses of various stimulus concentrations"}
knitr::include_graphics(c('figs/v1/fig_ML_spikes_ID.png')) 
```

### Effect of CaFR

```{r MLspk, out.width = "80%", fig.cap="Altered Morris-Lecar model for action potentials in ORN"}
knitr::include_graphics(c('figs/v1/fig_ML_spikes.png')) 
```

```{r aCaFR1, out.width = "80%", fig.cap="Simulations with keeping CaFR=1 for the entire duration"}
knitr::include_graphics(c('figs/Appendix/supp_fig_ML_ID_w_CaFR_1.png')) 
```

### Differences in adding  Morris-Lecar dynamics

```{r MLover, out.width = "80%", fig.cap="Simulations with ML integrated into molecular process (top) and added ML-spikes separately post-simulation (bottom)"}
knitr::include_graphics(c('figs/Appendix/supp_fig_ML_spikes_OVERLAP.png')) 
```

\clearpage

# Appendix B : Sniffing-simulation plots {-}

```{r f10bpm, out.width = "80%", fig.cap="Sniffing at 10 breaths/min over-all"}
knitr::include_graphics(c('figs/sniff/fig_spk_sniffing_10bpm.png')) 
```

```{r f10bpmSS, out.width = "80%", fig.cap="Sniffing at 10 breaths/min : steady-state response zoom-in"}
knitr::include_graphics(c('figs/sniff/fig_spk_sniffing_10bpm_last.png')) 
```

```{r f35bpm, out.width = "80%", fig.cap="Sniffing at 35 breaths/min over-all"}
knitr::include_graphics(c('figs/sniff/fig_spk_sniffing_35bpm.png')) 
```

```{r f50bpm, out.width = "80%", fig.cap="Sniffing at 50 breaths/min over-all"}
knitr::include_graphics(c('figs/sniff/fig_spk_sniffing_50bpm.png')) 
```

\clearpage

# Appendix C : Codes {-}

## Matlab simulation {-}

simulate_ORN.m

## All other codes {-}

- All Matlab simulation script, Matlab scripts for all figures, tex/md files for generating this report and figures files are available here : 
  + <[Google Drive](https://drive.google.com/drive/folders/1N4nMSW9fY1oOydNJQu4aa85tXOV_euu4?usp=sharing)>
  + <[github.com/shivanshdave](https://drive.google.com/drive/folders/1N4nMSW9fY1oOydNJQu4aa85tXOV_euu4?usp=sharing)>

# References

